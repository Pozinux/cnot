<div>Il y a des examples de find dans le man si besoin. Il faut chercher la section "EXAMPLES".</div><div><br></div><div><hr></div><div><br></div><div><span style="font-weight: bold;">Trouver un fichier</span></div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div># find chemin_où_chercher -name "fichier"</div><div><br></div><div># find /home -iname fic*</div></div><div><br></div><div>NOTE : find -iname pour ne pas prendre en compte la casse</div><div><br></div><div><span style="font-weight: bold;">Lister&nbsp;</span></div><div><br></div><div>Lister tous les fichiers et les répertoires à partir du répertoire courant :</div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div>[root@serveur var]# find</div><div>./lib/authconfig</div><div>./lib/authconfig/last</div><div>./lib/centreon</div><div>./lib/centreon/centplugins</div><div>./lib/centreon/centplugins/traffic_if58_10.229.19.38</div><div>./lib/centreon/centplugins/traffic_if369098952_10.29.152.12</div><div>./lib/centreon/centplugins/traffic_if436310016_10.29.152.11</div><div>./lib/centreon/centplugins/traffic_if436289536_10.30.170.11</div></div><div><br></div><div><span style="font-size: 10pt; color: rgb(1, 1, 1); font-family: Arial;">Ne lister que les répertoires :</span></div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div>[root@serveur var]# find -type d</div><div>.</div><div>./lost+found</div><div>./local</div><div>./yp</div><div>./crash</div><div>./preserve</div><div>./lib</div><div>./lib/hiera</div><div>./lib/rpm</div><div>./lib/authconfig</div></div><div><br></div><div>Ne lister que les fichiers :</div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div>[root@SERV90410 var]# find -type f</div><div>./lib/rpm/Triggername</div><div>./lib/rpm/__db.001</div><div>./lib/rpm/Filedigests</div><div>./lib/rpm/__db.002</div><div>./lib/rpm/Install</div><div>./lib/rpm/Sha1header</div><div>./lib/rpm/Provideversion</div><div>./lib/rpm/Pubkeys</div><div>./lib/rpm/Requireversion</div><div>./lib/rpm/Name</div></div><div><span style="font-size:12pt"><br></span></div><div>Lister les fichiers et répertoires modifiés de plus de 16 jours :</div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div>[root@SERV90640 waarp]# find /loga/waarp/ -mtime +16 -ls</div><div>&nbsp; &nbsp; 39 &nbsp; 12 -rw-rw-rw- &nbsp; 1 root &nbsp; &nbsp; root &nbsp; &nbsp; &nbsp; &nbsp; 8838 mars &nbsp;4 07:54 /loga/waarp/p1-eesegyrfc</div><div>&nbsp; &nbsp; 49 &nbsp; &nbsp;8 -rw-rw-rw- &nbsp; 1 root &nbsp; &nbsp; root &nbsp; &nbsp; &nbsp; &nbsp; 6620 mars &nbsp;3 08:21 /loga/waarp/p1-eesegyrfc</div><div>&nbsp; &nbsp; 47 &nbsp; 12 -rw-rw-rw- &nbsp; 1 root &nbsp; &nbsp; root &nbsp; &nbsp; &nbsp; &nbsp;11682 mars &nbsp;1 08:13 /loga/waarp/p1-eesegyrfc</div><div>&nbsp; &nbsp; 48 &nbsp; &nbsp;8 -rw-rw-rw- &nbsp; 1 root &nbsp; &nbsp; root &nbsp; &nbsp; &nbsp; &nbsp; 7110 mars &nbsp;2 07:00 /loga/waarp/p1-eesegyrfc</div></div><div><span style="font-size:12pt"><br></span></div><div>ou bien</div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">[root@SERV90640 waarp]# find /loga/waarp/ -mtime +16 -exec ls -l {} \;</div><div><br></div><div>Lister les fichiers du home modifiés il y a moins de 24h (voir "man find" dans la section EXAMPLES pour l'explication) :</div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"># find ~ -mtime 0</div><div><br></div><div>ou bien :</div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"># find ~ -mtime 1 -print | more</div><div><br></div><div>Le problème c'est que cette commande va rechercher même dans proc, dev et sys qui sont en mémoire et changent tout le temps. Donc pour les exlure :</div><div><br></div><div>Lister les fichiers modifiés il y a moins de 10 minutes (ne pas rechercher dans /sys /dev /proc) :</div><div><br></div><div style="padding: 8px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">[root@centos2 ~]# find / -not -path '/sys*' -not -path '/dev*' -not -path '/proc*' -mmin -10</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/run/utmp</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/run/udev</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/run/log/journal/e1ac24cbe9f94f2caa228d77e027be8b</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/run/log/journal/e1ac24cbe9f94f2caa228d77e027be8b/system.journal</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/run/systemd/users</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/run/systemd/users/0</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/run/systemd/sessions</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/run/systemd/system</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/root/.bash_history</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/root/.lesshst</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/var/lib/rsyslog</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/var/lib/rsyslog/imjournal.state</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/var/log/wtmp</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/var/log/audit/audit.log</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/var/log/messages</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">/var/log/secure</span></span></div></div><div><br></div><div>Pour lister ce qui se trouve sur un FS mais sans sortir du FS :</div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div>[f9xvq00@bunh /$ find . -xdev</div><div>...</div><div>./lib/modules/2.6.32-220.el6.x86_64/modules.networking</div><div>./lib/modules/2.6.32-220.el6.x86_64/modules.inputmap</div><div>./lib/modules/2.6.32-220.el6.x86_64/modules.block</div><div>./lib/modules/2.6.32-220.el6.x86_64/modules.symbols</div><div>./lib/modules/2.6.32-220.el6.x86_64/modules.seriomap</div><div>./lib/modules/2.6.32-220.el6.x86_64/modules.alias.bin</div><div>./lib/modules/2.6.32-220.el6.x86_64/modules.ofmap</div><div>./lib/modules/2.6.32-220.el6.x86_64/modules.pcimap</div><div>./y950x00</div><div>./boot</div><div>./f9xvq00</div><div>./sys</div><div>./home</div><div>./save_syst</div><div>./dev</div></div><div><br></div><div>On voit bien que comme on demande à ne pas sortir du FS courant, on ne liste pas l'intérieur des FS /home /boot etc.</div><div>Ceux sont donc bien des FS dont le point de montage est sous /</div><div>Par contre, on voit bien que ce qui est sous /lib est bien dans / donc /lib est un répertoire de / mais pas un FS.</div><div><br></div><div><span style="font-weight: bold;">Exécuter une commande avec find sur tous les fichiers trouvés :</span></div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">find . -exec file '{}' \;</div><div><br></div><div>Explication (si je me souviens plus comment on l'écrit, voir "man find" dans la section EXAMPLES pour l'explication) :</div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">La commande file sera exécutée chaque résultat de find . (ira se placer à la place de "{}" jusqu'à ";" que l'on échappe par "\")</div><div><br></div><div>Même chose mais avec une confirmation :</div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">find . -exec file '{}' \;</div><div><br></div><div><br></div><div><span style="font-weight: bold;">Supprimer</span></div><div><br></div><div><span style="font-size: 10pt; color: rgb(1, 1, 1); font-family: Arial;">Supprimer les fichiers et répertoires modifiés (mtime sinon changés (de status) c'est ctime (et non créées) et accédés c'est atime) de plus de 16 jours (+X) :</span></div><div><br></div><div><span style="color: rgb(1, 1, 1);">Les lister d'abord :</span></div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">find . -mtime +X</div><div><br></div><div>puis les supprimer si ok :</div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">[root@SERV90640 waarp]# find . -mtime +16 -exec rm {} \;</div><div><br></div><div>Pour préciser que l'on veut supprimer seulement les fichier : -type f</div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">[root@SERV90640 waarp]# find /loga/waarp/ -type f -mtime +16 -exec rm {} \;</div><div><br></div><div><br></div><div><span style="font-weight: bold;">Supprimer tous les fichiers .log d'un répertoire</span></div><div><br></div><div>Se positionner dans le répertoire où se trouvent les fichier à supprimer puis :</div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"># find . -name ".log" -exec rm -rf {} \;</div><div><br></div><div><span style="font-weight: bold;">Lister les plus gros fichiers</span></div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"># find . -ls | awk '{printf("%12d %s %s %2d %5s %s \n",$7, $3, $8, $9, $10, $11)}' | sort -nr | head -25</div><div><br></div><div>ou plus simplement :</div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div>find . -ls | sort -nk 7 | tail</div><div><br></div><div>pour aligner :</div><div><br></div><div>find . -ls | sort -nk 7 | tail | column -t</div></div><div><br></div><div>La 7ième colonne indique la taille en octets et non pas la première colonne qui elle indique les inodes.</div><div><br></div><div>Pour infos, on peut classer les fichiers d'un répertoire par taille avec ls :</div><div><br></div><div style="padding: 8px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">[root@centos1 ~]# ls -lS</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">total 132</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">-rw-r--r--. 1 root root 87272 May 29 13:30 bash-completion-2.1-6.el7.noarch.rpm</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">-rw-r--r--. 1 root root 27312 May&nbsp; 3 11:49 install.log</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">-rw-r--r--. 1 root root&nbsp; 7572 May&nbsp; 3 11:48 install.log.syslog</span></span></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">-rw-------. 1 root root&nbsp; 1424 May&nbsp; 3 11:49 anaconda-ks.cfg</span></span></div></div><div><br></div><div><span style="font-size: 10pt; color: rgb(1, 1, 1); font-family: Arial;">On peut aussi utiliser "du" pour lister la taille des répertoires puis l'utiliser dans la commande find :</span></div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div>[root@SERV90640 p1]# du -cmsh *</div><div>4,0K &nbsp; &nbsp;activemq</div><div>4,0K &nbsp; &nbsp;install</div><div>23M &nbsp; &nbsp; mongo</div><div>39M &nbsp; &nbsp; refcoll</div><div>103M &nbsp; &nbsp;solr</div><div>4,5G &nbsp; &nbsp;tomcat</div><div>3,5M &nbsp; &nbsp;tools</div><div>4,6G &nbsp; &nbsp;total</div></div><div><br></div><div><span style="font-size: 10pt; color: rgb(1, 1, 1); font-family: Arial; font-weight: bold;">Si trop de fichiers à lister, pour voir leur taille :</span></div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">[root@SERV90410 centreontrapd]# &nbsp;find /var/spool/centreontrapd/ -type f -exec du -mh {} \;</div><div><br></div><div><span style="font-size: 10pt; color: rgb(1, 1, 1); font-family: Arial; font-weight: bold;">Trouver un répertoire qui commence par "Cen" :</span></div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div>[root@centos1 yum.repos.d]# find / -type d -name "Cen*"</div><div>/media/CentOS</div><div>/usr/share/wallpapers/CentOS6</div><div>/usr/share/kde4/apps/kdm/themes/CentOS6</div><div>/usr/share/kde4/apps/ksplash/Themes/CentOS6</div></div><div><br></div><div><span style="font-weight: bold;">Trouver les répertoires vides :</span></div><div><br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"># find . -type d -empty</div><div><br></div><div><span style="font-weight: bold;">Trouver les fichiers d'un user (pratique lorsque l'on a supprimé le user)</span></div><div><br></div><div style="padding: 8px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;"># find / -user USERNAME</span></span></div><div><br></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;">ou bien</span></span></div><div><br></div><div><span style="font-size: 12px;"><span style="font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace;"># find / -uid UID</span></span></div></div><div><br></div>