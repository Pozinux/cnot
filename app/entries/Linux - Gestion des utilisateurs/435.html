<div><span style="font-weight: bold;">Supprimer un utilisateur proprement (câd pas seulement le userdel)</span></div><div>&nbsp;<br></div><div>Locker le compte de l'utilisateur :</div><div>&nbsp;<br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">passwd -l username</div><div>&nbsp;<br></div><div>Sauvegarder les fichiers de l'utilisateur sur /tmp/backup par exemple :</div><div>&nbsp;<br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">tar -zcvf /tmp/backup/username.tar.gz /home/username/</div><div>&nbsp;<br></div><div>Supprimer les process running qui appartiennent au compte :</div><div>&nbsp;<br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div>pgrep -u username</div><div>ps -fp $(pgrep -u username)</div><div>killall -KILL -u username</div></div><div>&nbsp;<br></div><div>Delete ses jobs :</div><div>&nbsp;<br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">find /var/spool/at/ -name "[^.]*" -type f -user username -delete</div><div>&nbsp;<br></div><div>Supprimer ses cron jobs :</div><div>&nbsp;<br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">crontab -r -u username</div><div>&nbsp;<br></div><div>Supprimer les print jobs :</div><div>&nbsp;<br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">lprm username</div><div>&nbsp;<br></div><div>Trouver tous les fichiers "owned" par username :</div><div>&nbsp;<br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">find / -user username</div><div>&nbsp;<br></div><div>On peut trouver tous les fichiers qui appartiennent à username et changer leur appartenance à newusername :</div><div>&nbsp;<br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);">find / -user username -exec chown newusername:newgroupname {} \;</div><div>&nbsp;<br></div><div><span style="text-decoration-line: underline;">Deux choix enfin pour la suppression :</span></div><div>&nbsp;<br></div><div><span style="color: rgb(255, 0, 0);">Attention</span> : lorsque l'on supprime un user on a même pas de demande de confirmation même si on supprime aussi ses fichiers avec -r</div><div>&nbsp;<br></div><div>1. Supprimer un utilisateur mais pas ses fichiers (ceux de son home) :</div><div>&nbsp;<br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"># userdel my_user</div><div>&nbsp;<br></div><div>2. Supprimer un utilisateur et tous ses fichiers (seulement ceux de son home - les autres fichiers devront être recherchés comme ci-dessus avec find) :</div><div>&nbsp;<br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><b><font color="#FF0000"># userdel -r my_user</font></b></div><div>&nbsp;<br></div><div>Vérifier que le user n'avait pas des droits sudo. Si c'est le cas supprimer la ligne :</div><div>&nbsp;<br></div><div style="padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);"><div># visudo</div><div>&nbsp;<br></div><div>## Allow root to run any commands anywhere</div><div>root ALL=(ALL) ALL</div><div>my_user ALL=(ALL) ALL</div></div><div>&nbsp;<br></div>